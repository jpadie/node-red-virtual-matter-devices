{
  "version": 3,
  "sources": ["../../../../src/session/case/CaseMessages.ts"],
  "sourcesContent": ["/**\n * @license\n * Copyright 2022-2024 Matter.js Authors\n * SPDX-License-Identifier: Apache-2.0\n */\nimport {\n    CRYPTO_AEAD_MIC_LENGTH_BYTES,\n    CRYPTO_GROUP_SIZE_BYTES,\n    CRYPTO_HASH_LEN_BYTES,\n    CRYPTO_PUBLIC_KEY_SIZE_BYTES,\n} from \"../../crypto/CryptoConstants.js\";\nimport { TlvUInt16 } from \"../../tlv/TlvNumber.js\";\nimport { TlvField, TlvObject, TlvOptionalField } from \"../../tlv/TlvObject.js\";\nimport { TlvByteString } from \"../../tlv/TlvString.js\";\nimport { ByteArray } from \"../../util/ByteArray.js\";\nimport { TlvSessionParameters } from \"../pase/PaseMessages.js\";\n\nconst CASE_SIGNATURE_LENGTH = CRYPTO_GROUP_SIZE_BYTES * 2;\n\nexport const KDFSR1_KEY_INFO = ByteArray.fromString(\"Sigma1_Resume\");\nexport const KDFSR2_KEY_INFO = ByteArray.fromString(\"Sigma2_Resume\");\nexport const RESUME1_MIC_NONCE = ByteArray.fromString(\"NCASE_SigmaS1\");\nexport const RESUME2_MIC_NONCE = ByteArray.fromString(\"NCASE_SigmaS2\");\nexport const KDFSR2_INFO = ByteArray.fromString(\"Sigma2\");\nexport const KDFSR3_INFO = ByteArray.fromString(\"Sigma3\");\nexport const TBE_DATA2_NONCE = ByteArray.fromString(\"NCASE_Sigma2N\");\nexport const TBE_DATA3_NONCE = ByteArray.fromString(\"NCASE_Sigma3N\");\n\n/** @see {@link MatterSpecification.v13.Core} \u00A7 4.14.2.3 */\nexport const TlvCaseSigma1 = TlvObject({\n    initiatorRandom: TlvField(1, TlvByteString.bound({ length: 32 })),\n    initiatorSessionId: TlvField(2, TlvUInt16),\n    destinationId: TlvField(3, TlvByteString.bound({ length: CRYPTO_HASH_LEN_BYTES })),\n    initiatorEcdhPublicKey: TlvField(4, TlvByteString.bound({ length: CRYPTO_PUBLIC_KEY_SIZE_BYTES })),\n    initiatorSessionParams: TlvOptionalField(5, TlvSessionParameters),\n    resumptionId: TlvOptionalField(6, TlvByteString.bound({ length: 16 })),\n    initiatorResumeMic: TlvOptionalField(7, TlvByteString.bound({ length: CRYPTO_AEAD_MIC_LENGTH_BYTES })),\n});\n\n/** @see {@link MatterSpecification.v13.Core} \u00A7 4.14.2.3 */\nexport const TlvCaseSigma2 = TlvObject({\n    responderRandom: TlvField(1, TlvByteString.bound({ length: 32 })),\n    responderSessionId: TlvField(2, TlvUInt16),\n    responderEcdhPublicKey: TlvField(3, TlvByteString.bound({ length: CRYPTO_PUBLIC_KEY_SIZE_BYTES })),\n    encrypted: TlvField(4, TlvByteString),\n    responderSessionParams: TlvOptionalField(5, TlvSessionParameters),\n});\n\n/** @see {@link MatterSpecification.v13.Core} \u00A7 4.14.2.3 */\nexport const TlvCaseSigma2Resume = TlvObject({\n    resumptionId: TlvField(1, TlvByteString.bound({ length: 16 })),\n    resumeMic: TlvField(2, TlvByteString.bound({ length: 16 })),\n    responderSessionId: TlvField(3, TlvUInt16),\n    responderSessionParams: TlvOptionalField(4, TlvSessionParameters),\n});\n\n/** @see {@link MatterSpecification.v13.Core} \u00A7 4.14.2.3 */\nexport const TlvCaseSigma3 = TlvObject({\n    encrypted: TlvField(1, TlvByteString),\n});\n\n/** @see {@link MatterSpecification.v10.Core} \u00A7 4.13.2.3 */\nexport const TlvSignedData = TlvObject({\n    nodeOpCert: TlvField(1, TlvByteString),\n    intermediateCACert: TlvOptionalField(2, TlvByteString),\n    ecdhPublicKey: TlvField(3, TlvByteString.bound({ length: CRYPTO_PUBLIC_KEY_SIZE_BYTES })),\n    peerEcdhPublicKey: TlvField(4, TlvByteString.bound({ length: CRYPTO_PUBLIC_KEY_SIZE_BYTES })),\n});\n\n/** @see {@link MatterSpecification.v10.Core} \u00A7 4.13.2.3 */\nexport const TlvEncryptedDataSigma2 = TlvObject({\n    nodeOpCert: TlvField(1, TlvByteString),\n    intermediateCACert: TlvOptionalField(2, TlvByteString),\n    signature: TlvField(3, TlvByteString.bound({ length: CASE_SIGNATURE_LENGTH })),\n    resumptionId: TlvField(4, TlvByteString.bound({ length: 16 })),\n});\n\n/** @see {@link MatterSpecification.v10.Core} \u00A7 4.13.2.3 */\nexport const TlvEncryptedDataSigma3 = TlvObject({\n    nodeOpCert: TlvField(1, TlvByteString),\n    intermediateCACert: TlvOptionalField(2, TlvByteString),\n    signature: TlvField(3, TlvByteString.bound({ length: CASE_SIGNATURE_LENGTH })),\n});\n"],
  "mappings": "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",
  "names": []
}
